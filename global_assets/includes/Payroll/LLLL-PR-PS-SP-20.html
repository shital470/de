
<div class="row justify-content-center">
    <div class="col">
        <div class="card">
            <div class="card-header" style="">
                <!--padding: 0.9rem 1rem 0.2rem 1rem !important;-->
                <div class="row">
                    <div class="col-lg-6 col-xs-2">
                        <!--<h4><span class="card-title">Groups</span></h4>-->

                    </div>
                    <div class="col-lg-6">
                        <a href="#!" class="btn btn-sm btn-primary float-right" style="margin-right:8px;">Cancel</a>
                        <a href="#!" class="btn btn-sm btn-primary float-right" id="deletebtnID" style="margin-right: 8px; display: none;">Delete</a>
                        <a href="#!" class="btn btn-sm btn-primary float-right" id="updatebtnID" style="margin-right: 8px; display: none;">Update</a>
                        <a href="#!" class="btn btn-sm btn-primary float-right" id="savebtnid" style="margin-right:8px;">Save</a>
                    </div>
                </div>
            </div>

            <!--Form layout-->

            <div class="card-body">
                <div class="row">
                    <div class="col-lg-6">
                        <div class="collapse show">
                            <form action="#">
                                <div class="form-group row">
                                    <label class="offset-1 col-lg-5 col-form-label">Employee Number&nbsp;:</label>
                                    <div class="col-lg-5">
                                        <input type="text" class="form-control" id="EmpNUmID">
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label class="col-lg-5 offset-1 col-form-label">Function&nbsp;:</label>
                                    <div class="col-lg-5">
                                        <input type="text" class="form-control" id="FunID">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-5 offset-1 col-form-label">Designation&nbsp;:</label>
                                    <div class="col-lg-5">
                                        <input type="text" class="form-control" id="DesID">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-5 offset-1 col-form-label">Location&nbsp;:</label>
                                    <div class="col-lg-5">
                                        <input type="text" class="form-control" id="LocID">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-5 offset-1 col-form-label">Bank Details&nbsp;:</label>
                                    <div class="col-lg-5">
                                        <input type="text" class="form-control" id="BADEID">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-5 offset-1 col-form-label">Date Of Joining&nbsp;:</label>
                                    <div class="col-lg-5">
                                        <input type="text" class="form-control" id="DOJID">
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!--2nd column started-->
                    <div class="col-lg-6">
                        <div class="collapse show">
                            <form action="#">
                                <div class="form-group row">
                                    <label class="col-lg-5 offset-1 col-form-label">Income Tax Number(PAN)&nbsp;:</label>
                                    <div class="col-lg-5">
                                        <input type="text" class="form-control" id="INCID">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-5 offset-1 col-form-label">PF Account Number &nbsp;:</label>
                                    <div class="col-lg-5">
                                        <input type="text" class="form-control" id="ACCID">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-5 offset-1 col-form-label">ESI Number&nbsp;:</label>
                                    <div class="col-lg-5">
                                        <input type="text" class="form-control" id="ESIID">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-5 offset-1 col-form-label">PR Account Number(PRAN)&nbsp;:</label>
                                    <div class="col-lg-5">
                                        <input type="text" class="form-control" id="PRAccID">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-5 offset-1 col-form-label">Passport Details&nbsp;:</label>
                                    <div class="col-lg-5">
                                        <input type="text" class="form-control" id="PassID">
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="row">
                <div class="col-lg-6">
                    <div id="table_area">
                        <table class="table" id="Group_tbl" border="0">
                            <thead>
                                <tr>
                                    <th>List of Employee</th>
                                    <th>Function</th>
                                    <th>Category</th>
                                </tr>
                            </thead>
                            <tbody id="groups_tbody">
                            </tbody>
                            <tfoot>
                                <tr>
                                    <th>Total Earning</th>
                                    <th id="currID"></th>
                                    <th id="YTDID"></th>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div id="table_area">
                        <table class="table" id="Group_tbl1" border="0">
                            <thead>
                                <tr>
                                    <th>List of Employee</th>
                                    <th>Function</th>
                                    <th>Category</th>
                                </tr>
                            </thead>
                            <tbody id="groups_tbody1">
                            </tbody>
                            <tfoot>
                                <tr>
                                    <th>Total Deductions</th>
                                    <th id="currID1"></th>
                                    <th id="YTDID1"></th>
                                </tr>
                                <tr>
                                    <th>Net Amount</th>
                                    <th id="currID2"></th>
                                    <th id="YTDID2"></th>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
                </div>
            </div>
            </div>
    </div>
</div>

<!--popup script-->

<script>
        var modal = document.getElementById("myModal");

        // Get the button that opens the modal
        var btn = document.getElementById("YesGSTDetailsId");

        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];

        // When the user clicks the button, open the modal
        btn.onclick = function () {
            modal.style.display = "block";
        }
        // When the user clicks on <span> (x), close the modal
        span.onclick = function () {
            modal.style.display = "none";
        }

</script>

<!--second pop up model javascript-->
<script>
        var secondmodal = document.getElementById("SecondModal");

        // Get the button that opens the modal
        var btn = document.getElementById("YesTaxDetailsId");

        // Get the <span> element that closes the modal
        var secondspan = document.getElementsByClassName("secondModclosecls")[0];

        // When the user clicks the button, open the modal
        btn.onclick = function () {
            secondmodal.style.display = "block";
        }
        // When the user clicks on <span> (x), close the modal
        secondspan.onclick = function () {
            secondmodal.style.display = "none";
        }

</script>

<!--third pop up model javascript-->
<script>
        var thirdmodal = document.getElementById("thirdModal");

        // Get the button that opens the modal
        var btn = document.getElementById("YesTDSDetailsId");

        // Get the <span> element that closes the modal
        var thirdspan = document.getElementsByClassName("thirdModclosecls")[0];

        // When the user clicks the button, open the modal
        btn.onclick = function () {
            thirdmodal.style.display = "block";
        }
        // When the user clicks on <span> (x), close the modal
        thirdspan.onclick = function () {
            thirdmodal.style.display = "none";
        }

</script>
<!--forth pop up model javascript-->
<script>
        var forthModal = document.getElementById("forthModal");

        // Get the button that opens the modal
        var btn = document.getElementById("YesTCSDetailsId");

        // Get the <span> element that closes the modal
        var forthspan = document.getElementsByClassName("forthModclosecls")[0];

        // When the user clicks the button, open the modal
        btn.onclick = function () {
            forthModal.style.display = "block";
        }
        // When the user clicks on <span> (x), close the modal
        forthspan.onclick = function () {
            forthModal.style.display = "none";
        }

</script>

<!--fifth pop up model javascript-->
<script>
        var fifthModal = document.getElementById("fifthModal");

        // Get the button that opens the modal
        var btn = document.getElementById("YesVATDetailsId");

        // Get the <span> element that closes the modal
        var fifthspan = document.getElementsByClassName("fifthModclosecls")[0];

        // When the user clicks the button, open the modal
        btn.onclick = function () {
            fifthModal.style.display = "block";
        }
        // When the user clicks on <span> (x), close the modal
        fifthspan.onclick = function () {
            fifthModal.style.display = "none";
        }

</script>


<!--drop down list-->
<script type="text/javascript">
        $(function () {
            debugger

            var cccd = localStorage.getItem('CCAC');
            // alert(cccd + "CCCD");
            $.ajax
                ({
                    async: 'false',
                    url: URLPowerAPI+'/api/PBXMLVGroups/GetAllPBXMLVGroup',
                    type: 'GET',
                    dataType: 'json',
                    contentType: 'application/json ; charset = utf-8',
                    data:
                    {
                        cccd: cccd
                    },
                    beforeSend: function () {
                        $("#loader1").show();
                    },
                    success: function (res) {
                        $("#loader1").hide();


                        $.each(res, function (index, value) {

                            $("#UnderValueId").append($("<option></option>").val(value.AccNo).html(value.GROUP));


                        });


                    }




                }

                );

        });



</script>

<!--add update-->

<script type="text/javascript">
        function Groupfunction() {
            // alert("in function");

            var url1 = window.location.href;
            var arr = url1.split('=');
            console.log(url1.length)

            if (arr.length > 1) {
                var mode = url1.split("=")[2];
                var AccNo1 = url1.split("=")[1];
                var index = (AccNo1).indexOf('&');
                var AccNo = AccNo1.substring(0, index);

            }
            var cccd = localStorage.getItem('CCAC');
            if ($("#YesSubLedgerId").prop("checked")) {
                var SubLedger = "Yes"
            }
            else {
                var SubLedger = "No"
            }
            if ($("#YesNetDebitId").prop("checked")) {
                var NetDebCr = "Yes"
            }
            else {
                var NetDebCr = "No"
            }
            if ($("#YesCalculationId").prop("checked")) {
                var Usecal = "Yes"
            }
            else {
                var Usecal = "No"
            }
            if ($("#YesGSTDetailsId").prop("checked")) {
                var GSTDet = "Yes"
            }
            else {
                var GSTDet = "No"
            }
            if ($("#YesTaxDetailsId").prop("checked")) {
                var TaxDet = "Yes"
            }
            else {
                var TaxDet = "No"
            }
            if ($("#YesTDSDetailsId").prop("checked")) {
                var TDSDet = "Yes"
            }
            else {
                var TDSDet = "No"
            }
            if ($("#YesTCSDetailsId").prop("checked")) {
                var TCSDet = "Yes"
            }
            else {
                var TCSDet = "No"
            }
            if ($("#YesVATDetailsId").prop("checked")) {
                var VATDet = "Yes"
            }
            else {
                var VATDet = "No"
            }

            var under = $("#UnderValueId option:selected").text();
            var MetoAlloc = $("#AllocateMethodId option:selected").text();
            var CurrentDate = new Date();
            var curndate = CurrentDate.toISOString().replace('Z', '');
            var status = "A";


            //storesession value
            var UId;
            var Username;
            var Createdsystem;
            var Createdate;

            if (mode == 'edit') {
                AccNo = AccNo,
                    UId = sessionStorage.getItem('uid');
                Username = sessionStorage.getItem('username');
                Createdsystem = sessionStorage.getItem('createdsystem');
                Createdate = sessionStorage.getItem('createddate');

            }
            else {
                AccNo = localStorage.getItem('MaxAccNo');
                UId = localStorage.getItem('UID');
                Username = localStorage.getItem('UName');
                Createdsystem = 'PowerSuit';
                Createdate = curndate;
            }
            var parameter = {
                AccNo: AccNo,
                GROUP: $("#Group-username").val(),
                NAME: $("#Group-username").val(),
                PARENT: under,
                ISSUBLEDGER: SubLedger,
                BASICGROUPISCALCULABLE: Usecal,
                ADDLALLOCTYPE: MetoAlloc,
                GSTDETAILSLIST: GSTDet,
                SERVICETAXDETAILSLIST: TaxDet,
                VATDETAILSLIST: VATDet,
                CCCD: cccd,
                STATUS: status,
                CREATEDSYSTEM: Createdsystem,
                LASTUPDATEDSYSTEM: 'PowerSuit',
                UID: UId,
                USERNAME: Username,
                LUID: localStorage.getItem('UID'),
                LUSERNAME: localStorage.getItem('UName'),
                CREATEDDATE: Createdate,
                LASTUPDATEDDATE: curndate
            }
            return parameter
        }
        $("#savebtnid").click(function () {

            // alert("ghggg");
            var addgroupparameter = Groupfunction();
            // alert(addcostcatparameter + "json");

            $.ajax
                ({
                    type: 'POST',
                    url: URLPowerAPI+'/api/PBXMLGroup/AddPBXMLGroup',
                    dataType: 'JSON',
                    data: JSON.stringify(addgroupparameter),

                    contentType: 'application/json ; charset = utf-8',
                    success: function (data, textStatus, xhr) {

                        alert('Added successfully');
                        window.location.href = "LLLL-MA-GR-50.shtml";
                    },
                    error: function (xhr, textStatus, errorThrown) {
                        alert("You entered some invalid fields...! Fill the details again...");
                    }
                });

            return;

        });

        $("#savebtnid").show();
        $("#cancelbtnid").show();
        $("#deletebtnID").hide();
        $("#updatebtnID").hide();

        $("#updatebtnID").click(function () {

            var addgroupparameter = Groupfunction();
            $.ajax
                ({
                    type: 'POST',
                    url: URLPowerAPI+'/api/PBXMLGroup/EditPBXMLGroup',
                    dataType: 'JSON',
                    data: JSON.stringify(addgroupparameter),
                    contentType: 'application/json ; charset = utf-8',
                    success: function (data, textStatus, xhr) {
                        alert('Updated successfully');
                        window.location.href = "LLLL-MA-GR-50.shtml";
                    },
                    error: function (xhr, textStatus, errorThrown) {
                        alert("You entered some invalid fields...! Fill the details again...");
                    }
                });
            return;
        });
</script>

<!--Get by Id-->

<script>
        $(document).ready(function () {
            var url1 = window.location.href;
            var mode = url1.split("=")[2];
            var AccNo1 = url1.split("=")[1];
            var index = (AccNo1).indexOf("&");
            var AccNo = AccNo1.substring(0, index);
            var cccd = localStorage.getItem('CCAC');
            // alert(AccNo);

            if (mode == 'edit') {
                $.ajax({
                    type: 'GET',
                    url: URLPowerAPI+'/api/PBXMLGroup/GetPBXMLGroupByID',
                    dataType: 'JSON',
                    contentType: 'application/json ; charset = utf-8',
                    //data: JSON.stringify(groupname),
                    data: {
                        cccd: cccd,
                        AccNo: AccNo
                    },

                    success: function (data) {
                        GroupObject = data;

                        $("#Group-username").val(GroupObject.NAME);
                        $("#Group-name").val(GroupObject.NAME);
                        // alert(GroupObject.NAME);
                        $('#UnderValueId option:selected').text(GroupObject.PARENT);
                        $('#AllocateMethodId option:selected').text(GroupObject.ADDLALLOCTYPE);
                        // alert("ADDLALLOCTYPE" + GroupObject.ADDLALLOCTYPE);

                        if (GroupObject.ISSUBLEDGER == 'Yes') {
                            $("#YesSubLedgerId").attr('checked', 'checked');
                        } else {
                            $("#NoSubLedgerId").attr('checked', 'checked');
                        }
                        if (GroupObject.ISADDABLE == 'Yes') {
                            $("#YesNetDebitId").attr('checked', 'checked');
                        } else {
                            $("#NoNetDebitId").attr('checked', 'checked');
                        }

                        if (GroupObject.BASICGROUPISCALCULABLE == 'Yes') {
                            $("#YesCalculationId").attr('checked', 'checked');
                        } else {
                            $("#NoCalculationId").attr('checked', 'checked');
                        }


                        sessionStorage.setItem('uid', GroupObject.UID);
                        sessionStorage.setItem('username', GroupObject.USERNAME);
                        sessionStorage.setItem('createdsystem', GroupObject.CREATEDSYSTEM);
                        sessionStorage.setItem('createddate', GroupObject.CREATEDDATE);
                        sessionStorage.setItem('lastupdatedate', GroupObject.LASTUPDATEDDATE);

                    },

                });
            }

            $("#deletebtnID").show();
            $("#updatebtnID").show();
            $("#savebtnid").hide();

            $("#deletebtnID").click(function () {

                var urls = window.location.href;
                debugger
                //alert(urls);
                var cccd = localStorage.getItem('CCAC');
                var group = AccNo;

                $.ajax({
                    url: URLPowerAPI+'/api/PBXMLGroup/DeletePBXMLGroup',
                    type: 'GET',
                    dataType: 'JSON',
                    data: {
                        cccd: cccd,
                        AccNo: group

                    },
                    contentType: 'application/json ; charset = utf-8',
                    success: function (data, textStatus, xhr) {
                        alert("Deleted successfully");
                        window.location.href = "LLLL-MA-GR-50.shtml";

                    },
                    error: function (xhr, textStatus, errorThrown) {
                        alert("You entered wrong password...! Fill the details again...");
                    }
                });
            });

        });

</script>


<script type="text/javascript">
        $(document).ready(function () {
            $("#companynameId").text(localStorage.getItem('CCNM') + '(' + localStorage.getItem('FinancialYrFrom') + ')');

        });
</script>

<script type="text/javascript">
        $(document).ready(function () {
            $("#userId").text(localStorage.getItem('UName'));
            set_MainHeaderName();
        });

    function set_MainHeaderName() {
        $('#MainPHead_Name').html('<i class="icon-arrow-left52 mr-2"></i> <span class="font-weight-semibold" id="main_id">Payroll</span> - Statement Of Payroll - Single Pay Slip');
        $('#MainPHead_Name1').html('<a href="#" class="breadcrumb-item"><i class="icon-home2 mr-2"></i>Payroll</a><span class="breadcrumb-item active">Statement Of Payroll / Single Pay Slip</span>');
    };

</script>
