<!-- /main charts -->
<!-- Dashboard content -->
<!-- my code2 -->

<div class="row justify-content-center">
   
    <div class="col">
        <div class="card">
            <div class="card-header">
                <div class="row">
                    <div class="col-lg-6 col-xs-2">
                        <!--<h4><span class="card-title">User   : HOME</span></h4>-->
                    </div>
                    <div class="col-lg-6">
                        <a href="#!" class="btn btn-sm btn-primary float-right" style="margin-right:8px;">Cancel</a>
                        <a href="#!" class="btn btn-sm btn-primary float-right" id="deletebtnID" style="display: none; margin-right: 8px;">Delete</a>
                        <a href="#!" class="btn btn-sm btn-primary float-right" id="updatebtnID" style="display: none; margin-right: 8px;">Update</a>
                        <a href="#!" class="btn btn-sm btn-primary float-right" style="margin-right:8px;" id="savebtnid">Save</a>
                    </div>
                </div>
            </div>

            <!--Form layout-->
            <div class="card-body">
                <div class="row">

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">&nbsp; Case Ownerr:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control UserId " value="" id="">
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">
                                Product Name*&nbsp;:
                            </label>
                            <div class="col-lg-6">

                                <select class="form-control" id="ProductNameId">
                                    <option>--Select--</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="row">
                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">
                                Type&nbsp;:
                            </label>
                            <div class="col-lg-6">
                                <select class="form-control selectclass" id="TypeId">
                                    <option value="1">--Select--</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">
                                Status*&nbsp;:
                            </label>
                            <div class="col-lg-6">
                                <select class="form-control" id="StatusId">
                                    <option>--Select--</option>
                                </select>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="row">
                    <div class="col-lg-6">

                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">
                                Case Origin*&nbsp;:
                            </label>
                            <div class="col-lg-6">
                                <select class="form-control" id="CaseOrgId">
                                    <option>--Select--</option>
                                </select>
                            </div>
                        </div>

                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">
                                Priority*&nbsp;:
                            </label>
                            <div class="col-lg-6">
                                <select class="form-control" id="PriorityId">
                                  
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">
                                Account Name&nbsp;:
                            </label>
                            <div class="col-lg-6">
                                <select class="form-control" id="AccountNameId">
                                    <option>--Select--</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">
                                Case Reason&nbsp;:
                            </label>
                            <div class="col-lg-6">
                                <select class="form-control" id="CaseResId">
                                    <option>--Select--</option>
                                </select>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="row">

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Reported By&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control UserId"  id="ReportedById">
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">
                                Related To&nbsp;:
                            </label>
                            <div class="col-lg-6">
                                <select class="form-control" id="RelatedToId">
                                    <option>--Select--</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Phone&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="number" class="form-control" id="PhoneId">
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">
                                Opportunity Name&nbsp;:
                            </label>
                            <div class="col-lg-6">
                                <select class="form-control" id="OppNameId">
                                    <option>--Select--</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Email&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="email" class="form-control" id="EmailId">
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Subject&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="SubjectId">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Description&nbsp;:</label>
                            <div class="col-lg-6">
                                <textarea type="text" class="form-control" id="DiscribtionId"></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label"> Internal Comments&nbsp;:</label>
                            <div class="col-lg-6">
                                <textarea type="text" class="form-control" id="InternalComId"></textarea>
                            </div>
                        </div>
                    </div>
                </div>




            </div>
        </div>


    </div>
</div>




<!--<script src="../assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="../assets/vendor/js-cookie/js.cookie.js"></script>
<script src="../assets/vendor/jquery.scrollbar/jquery.scrollbar.min.js"></script>
<script src="../assets/vendor/jquery-scroll-lock/dist/jquery-scrollLock.min.js"></script>-->
<!-- Argon JS -->
<!--<script src="../assets/js/argon.js?v=1.2.0"></script>
<script src="../assets/vendor/jquery/dist/jquery.min.js"></script>-->

<!-- Argon Scripts -->
<!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>-->

<!--model link-->

<!--<script src="../Model/CrmContact.js" type="text/javascript"></script>-->

<!--sidebar code-->
<script>
    $(document).ready(function () {

       // $('#content').load("Sidebar.html");
        set_MainHeaderName();
        $(".UserId").val(localStorage.getItem('UName'));

       

    });</script>

<script>
    $(document).ready(function set_MainHeaderName() {
        $('#MainPHead_Name').html('<i class="icon-arrow-left52 mr-2"></i> <span class="font-weight-semibold" id="main_id">CRM</span> - Case');
        $('#MainPHead_Name1').html('<a href="#" class="breadcrumb-item"><i class="icon-home2 mr-2"></i>CRM</a><span class="breadcrumb-item active"> Case</span>');
    });
</script>

<!--dropdown list-->
<script type="text/javascript">
    $(function () {
        debugger
        GetParameterType('CTYP');
        GetParameterType('CORG');
        GetParameterType('CLST');
        GetParameterType('CRSN');
        GetParameterType('PRI');


    });
    //create first function for getparameretertypeid
    function GetParameterType(parametertype) {
        /*alert(parametertype);*/
        debugger
        var cccd = localStorage.getItem('CCAC');
        $.ajax({
            type: "GET",
            url: URLPowerAPI+'/api/PBXMLParameter/GetParameterTypeID',
            dataType: "json",
            contentType: "application/json",

            data: {
                PARTYPE: parametertype,
                cccd: cccd
            },
            beforeSend: function () {
                $("#loader1").show();
            },
            async: false,

            success: function (res) {
                $("#loader1").hide();
                var abc = res;
                GetDropDown(abc, parametertype);

            }

        });
    }


    //second function for dropdown
    function GetDropDown(parameter, parametertype) {
        debugger
        /*alert(parameter);*/

        var cccd = localStorage.getItem('CCAC');
        $.ajax({
            type: "GET",
            url: URLPowerAPI+'/api/PBXMLParametercode/GetAllActiveParameterCodes',
            dataType: "json",
            contentType: "application/json",

            data: {
                PARTYPEID: parameter,
                cccd: cccd
            },
            async: false,
            success: function (res) {

                $.each(res, function (data, value) {
                    if (parametertype == 'CTYP') {
                        $("#TypeId").append($("<option></option>").val(value.ParCodeID).html(value.ParCodeDescription));
                    }
                    else if (parametertype == 'CORG') {
                        $("#CaseOrgId").append($("<option></option>").val(value.ParCodeID).html(value.ParCodeDescription));
                    }
                    else if (parametertype == 'CLST') {
                        $("#StatusId").append($("<option></option>").val(value.ParCodeID).html(value.ParCodeDescription));
                    }
                    else if (parametertype == 'CRSN') {
                        $("#CaseResId").append($("<option></option>").val(value.ParCodeID).html(value.ParCodeDescription));
                    }
                    else if (parametertype == 'PRI') {
                        $("#PriorityId").append($("<option></option>").val(value.ParCodeID).html(value.ParCodeDescription));
                    }

                })
            }

        });
    }
</script>



<script type="text/javascript">
    $(function () {
        debugger
        var cccd = localStorage.getItem('CCAC');

        $.ajax
            ({

                url: URLPowerAPI+'/api/PBXMLVStockGroups/GetAllPBXMLVStockGroup',
                type: 'GET',
                dataType: 'json',
                contentType: 'application/json ; charset = utf-8',
                data:
                {
                    cccd: cccd

                },
                beforeSend: function () {
                    $("#loader1").show();
                },
                async: false,
                success: function (res) {
                    alert()
                    $("#loader1").hide();
                    $.each(res, function (index, value) {
                        $("#ProductNameId").append($("<option></option>").val(value.Itcd).html(value.STOCKGROUP));



                    });
                }

            });

    });



</script>

<script type="text/javascript">
    $(function () {
        debugger
        var cccd = localStorage.getItem('CCAC');

        $.ajax
            ({

                url: URLPowerAPI+'/api/PBXMLAccounts/GetAllCustomer',
                type: 'GET',
                dataType: 'json',
                contentType: 'application/json ; charset = utf-8',
                data:
                {
                    cccd: cccd

                },
                async: false,
                success: function (res) {
                    //alert("Data inside ajax...!!!")
                    //alert(JSON.stringify(res));
                    $.each(res, function (index, value) {
                        $("#AccountNameId").append($("<option></option>").val(value.ClId).html(value.Name));



                    });
                }

            });

    });



</script>

<script type="text/javascript">
    $(function () {
        debugger
        var cccd = localStorage.getItem('CCAC');

        $.ajax
            ({

                url: URLPowerAPI +'/api/PBXMLVContact/GetAllPBXMLContacts',
                type: 'GET',
                dataType: 'json',
                contentType: 'application/json ; charset = utf-8',
                data:
                {
                    cccd: cccd

                },
                async: false,
                success: function (res) {
                    $.each(res, function (index, value) {

                        var contactname = value.FirstName + " " + value.LastName;
                        $("#RelatedToId").append($("<option></option>").val(value.ContactNo).html(contactname));


                    });
                }

            });

    });



</script>

<script type="text/javascript">
    $(function () {
        debugger
        var cccd = localStorage.getItem('CCAC');

        $.ajax
            ({

                url: URLPowerAPI+'/api/PBXMLVOpportunity/GetAllPBXMLOpportunity',
                type: 'GET',
                dataType: 'json',
                contentType: 'application/json ; charset = utf-8',
                data:
                {
                    cccd: cccd

                },
                async: false,
                success: function (res) {
                    $.each(res, function (index, value) {
                        $("#OppNameId").append($("<option></option>").val(value.OppNo).html(value.OppName));



                    });
                }

            });

    });



</script>

<!--add update API-->
<script>
    function AddFunction() {
        debugger
      
        var url1 = window.location.href;
        var arr = url1.split('=');
        console.log(url1.length)

        if (arr.length > 1) {
            var mode = url1.split("=")[2];
            var CaseNo1 = url1.split("=")[1];
            var index = (CaseNo1).indexOf('&');
            var CaseNo = CaseNo1.substring(0, index);

        }
        var urls = window.location.href;
        var cccd = localStorage.getItem('CCAC');



        var ProductName = $("#ProductNameId option:selected").text();
        var Product = $("#ProductNameId option:selected").val();
        var TypeName = $("#TypeId option:selected").text();
        var Type = $("#TypeId option:selected").val();
        var StatusName = $("#StatusId option:selected").text();
        var Status = $("#StatusId option:selected").val();
        var CaseOriginName = $("#CaseOrgId option:selected").text();
        var CaseOrigin = $("#CaseOrgId option:selected").val();
        var PriorityName = $("#PriorityId option:selected").text();
        var Priority = $("#PriorityId option:selected").val();
        var Account = $("#AccountNameId option:selected").val();
        var AccountName = $("#AccountNameId option:selected").text();
        var CaseReasonName = $("#CaseResId option:selected").text();
        var CaseReason = $("#CaseResId option:selected").val();
        var RelatedToName = $("#RelatedToId option:selected").text();
        var RelatedTo = $("#RelatedToId option:selected").val();
        var PotentialName = $("#OppNameId option:selected").text();
        var Potential = $("#OppNameId option:selected").val();

        var CurrentDate = new Date();
        var curndate = CurrentDate.toISOString().replace('Z', '');
        var status = "A";


        //storesession value
        var UId;
        var Username;
        var Createdsystem;
        var Createdate;

        if (mode == 'edit') {
            CaseNo = CaseNo,
                UId = sessionStorage.getItem('uid');
            Username = sessionStorage.getItem('username');
            Createdsystem = sessionStorage.getItem('createdsystem');
            Createdate = curndate;
        }
        else {
            CaseNo = localStorage.getItem("MaxCaseNo");
            UId = localStorage.getItem('UID');
            Username = localStorage.getItem('UName');
            Createdsystem = 'PowerSuit';
            Createdate = curndate;
        }




        var parameter =
        {
            CaseNo: CaseNo,
            ReportedBy: $("#ReportedById").val(),
            Phone: $("#PhoneId").val(),
            Email: $("#EmailId").val(),
            Subject: $("#SubjectId").val(),
            Description: $("#DiscribtionId").val(),
            InternalComments: $("#InternalComId").val(),
            Product: Product,
            ProductName: ProductName,
            TypeName: TypeName,
            Type: Type,
            StatusName: StatusName,
            Status: Status,
            CaseOriginName: CaseOriginName,
            CaseOrigin: CaseOrigin,
            PriorityName: PriorityName,
            Priority: Priority,
            AccountName: AccountName,
            Account: Account,
            CaseReasonName: CaseReasonName,
            CaseReason: CaseReason,
            RelatedToName: RelatedToName,
            RelatedTo: RelatedTo,
            PotentialName: PotentialName,
            Potential: Potential,
            CCCD: cccd,
            STATUS: status,
            CaseOwner: UId,
            CaseOwnerName: Username,
            CREATEDSYSTEM: Createdsystem,
            LASTUPDATEDSYSTEM: 'PowerSuit',
            UID: UId,
            USERNAME: Username,
            LUID: Username,
            LUSERNAME: Username,
            CREATEDDATE: Createdate,
            LASTUPDATEDDATE: curndate,
            LastUpdatedBy: UId,
            CreatedBy: UId,
            SFID: "",
            SFXMLVAR:"SFobj"
              
        }
        return parameter;
    }

    $("#savebtnid").click(function () {
        alert("xsdc");
        var addparameter = AddFunction();
      //  localStorage.setItem('addparameterCase', JSON.stringify(addparameter));

        $.ajax
            ({
                type: 'POST',
                url: URLPowerAPI+'/api/PBXMLCase/ADDPBXMLCase',
                dataType: 'JSON',
                data: JSON.stringify(addparameter),
                contentType: 'application/json ; charset = utf-8',

                success: function (data, textStatus, xhr) {

                    alert('Case registered successfully');
                    window.location.href = "LLLL-CR-CS-50.shtml";
                },
                error: function (xhr, textStatus, errorThrown) {
                    alert("You entered some invalid fields...! Fill the details again...");
                }
            });

        return;

    });

    $("#updatebtnID").click(function () {

        var addparameter = AddFunction();
        localStorage.setItem('EditparameterCase', JSON.stringify(addparameter));

        $.ajax
            ({
                type: 'POST',
                url: URLPowerAPI+'/api/PBXMLCase/EditPBXMLCase',
                dataType: 'JSON',
                data: JSON.stringify(addparameter),
                contentType: 'application/json ; charset = utf-8',

                success: function (data, textStatus, xhr) {
                    alert('Case registered successfully');
                    window.location.href = "LLLL-CR-CS-50.shtml";
                },
                error: function (xhr, textStatus, errorThrown) {
                    alert("You entered some invalid fields...! Fill the details again...");
                }
            });
        return;
    });


</script>



<!--GET by id API-->
<script>
    $(document).ready(function () {
        debugger
        var value = 1;
       
       // set_MainHeaderName();
        var url1 = window.location.href;
        var mode = url1.split("=")[2];
        var AccNo1 = url1.split("=")[1];
        var index = (AccNo1).indexOf("&");
        var AccNo = AccNo1.substring(0, index);
        var cccd = localStorage.getItem('CCAC');
        // alert(AccNo);

        if (mode == 'edit') {
            $.ajax({
                type: 'GET',
                url: URLPowerAPI+'/api/PBXMLCase/GetPBXMLCaseByID',
                dataType: 'JSON',
                contentType: 'application/json ; charset = utf-8',
                //data: JSON.stringify(groupname),
                data: {
                    cccd: cccd,
                    CaseNo: AccNo
                },
                beforeSend: function () {
                    $("#loader1").show();
                },

                success: function (data) {
                    alert(JSON.stringify(data))
                    $("#loader1").hide();
                    data = data;


                    $("#ReportedById").val(data.ReportedBy);
                    $("#PhoneId").val(data.Phone);
                    $("#EmailId").val(data.Email);
                    $("#SubjectId").val(data.Subject);
                    $("#DiscribtionId").val(data.Description);
                    $("#InternalComId").val(data.InternalComments);
                    $('#TypeId option:selected').text(data.TypeName);
                    $('#TypeId option:selected').val(data.Type);

                    $('#ProductNameId  option:selected').text(data.ProductName);
                    $('#ProductNameId  option:selected').val(data.Product);

                    $('#StatusId  option:selected').text(data.StatusName);
                    $('#StatusId  option:selected').val(data.Status);

                    $('#CaseOrgId option:selected').text(data.CaseOriginName);
                    $('#CaseOrgId option:selected').val(data.CaseOrigin);

                    $('#PriorityId  option:selected').text(data.PriorityName);
                    $('#PriorityId  option:selected').val(data.Priority);

                    $('#AccountNameId  option:selected').text(data.AccountName);
                    $('#AccountNameId  option:selected').val(data.Account);

                    $('#CaseResId option:selected').text(data.CaseReasonName);
                    $('#CaseResId option:selected').val(data.CaseReason);

                    $('#RelatedToId  option:selected').text(data.RelatedToName);
                    $('#RelatedToId  option:selected').val(data.RelatedTo);

                    $('#OppNameId  option:selected').text(data.PotentialName);
                    $('#OppNameId  option:selected').val(data.Potential);

                    // alert("ADDLALLOCTYPE" + data.ADDLALLOCTYPE);





                    sessionStorage.setItem('uid', datadata.UID);
                    sessionStorage.setItem('username', data.USERNAME);
                    sessionStorage.setItem('createdsystem', data.CREATEDSYSTEM);
                    sessionStorage.setItem('createddate', data.CREATEDDATE);
                    sessionStorage.setItem('lastupdatedate', data.LASTUPDATEDDATE);

                },

            });
        }
        $("#deletebtnID").show();
        $("#updatebtnID").show();
        $("#savebtnid").hide();



        $("#deletebtnID").click(function () {
            debugger
            var urls = window.location.href;
            debugger
            //alert(urls);
            var cccd = localStorage.getItem('CCAC');
            var group = AccNo;

            $.ajax({
                url: URLPowerAPI+'/api/PBXMLCase/DeletePBXMLCase',
                type: 'GET',
                dataType: 'JSON',
                data: {
                    cccd: cccd,
                    CaseNo: group

                },

                contentType: 'application/json ; charset = utf-8',
                success: function (data, textStatus, xhr) {
                    alert("Case deleted successfully");
                    window.location.href = "LLLL-CR-CS-50.shtml";

                },
                error: function (xhr, textStatus, errorThrown) {
                    alert("You entered wrong password...! Fill the details again...");
                }
            });
        });

    });

</script>



<script>
    function set_MainHeaderName() {
        $('#MainPHead_Name').html('<i class="icon-arrow-left52 mr-2"></i> <span class="font-weight-semibold" id="main_id">CRM</span> - Case');
        $('#MainPHead_Name1').html('<a href="#" class="breadcrumb-item"><i class="icon-home2 mr-2"></i>CRM</a><span class="breadcrumb-item active"> Case</span>');
   };
</script>
