<!-- main content code -->

<div class="row justify-content-center">

    <div class="col">
        <div class="card">
            <div class="card-header">
                <div class="row">
                    <div class="col-lg-6 col-xs-2">
                        <!--<h4><span class="card-title">Lead:Create Lead</span></h4>-->
                    </div>
                    <div class="col-lg-6">
                        <a href="#!" class="btn btn-sm btn-primary float-right" style="margin-right:8px;">Cancel</a>
                        <a href="#!" class="btn btn-sm btn-primary float-right" id="deletebtnID" style="display: none; margin-right: 8px;">Delete</a>
                        <a href="#!" class="btn btn-sm btn-primary float-right" id="updatebtnID" style="display: none; margin-right: 8px;">Update</a>
                        <a href="#!" class="btn btn-sm btn-primary float-right" style="margin-right:8px;" id="savebtnid">Save</a>
                    </div>
                </div>
            </div>

            <!--Form layout-->
            <div class="card-body">
                <div class="col-lg-12">
                    <div class="card-header header-elements-inline" style="padding-top: 5px;padding-bottom: 20px;">
                        <!--<h6 class="font-weight-semibold">CREATE LEAD</h6>-->
                    </div>
                </div>

                <div class="row">

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Lead Owner &nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control UserId" disabled>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Company*&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="ComapanyId">
                            </div>
                        </div>
                    </div>
                </div>


                <div class="row">
                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">First Name&nbsp;:</label>
                            <div class="col-lg-6">

                                <div class="row">
                                    <div class="col-lg-4 col-md-4 col-sm-4">
                                        <select class="form-control" id="SalutationId">
                                            <option>--Select--</option>

                                        </select>
                                    </div>
                                    <div class="col-lg-8 col-md-8 col-sm-8">
                                        <input type="text" id="FirstNameId" class="form-control">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">
                                Last Name*&nbsp;:
                            </label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="LastNameId">
                            </div>
                        </div>
                    </div>

                </div>

                <div class="row">
                    <div class="col-lg-6">

                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Email &nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="EmailId">
                            </div>
                        </div>

                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">
                                Lead Source&nbsp;:
                            </label>
                            <div class="col-lg-6">
                                <select class="form-control" id="LeadSorceId">
                                    <option value="Select" selected>--select--</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">

                    <div class="col-lg-6">

                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Phone&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="PhoneId">
                            </div>
                        </div>

                    </div>

                    <div class="col-lg-6">

                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Mobile&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="MobileId">
                            </div>
                        </div>

                    </div>


                </div>

                <div class="row">


                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">
                                Industry&nbsp;:
                            </label>
                            <div class="col-lg-6">
                                <select class="form-control" id="IndustryId">
                                    <option value="Select" selected>--select--</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Annual Revenue&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="AnnualRevId" value="0">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">No Of Employee &nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="NoOfEmpId">
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Website&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="WebSiteId">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Skype ID&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="SkypeId">
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">
                                Lead Status&nbsp;:
                            </label>
                            <div class="col-lg-6">
                                <select class="form-control" id="LeadStatusId">
                                    <option value="Select" selected>--select--</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">
                                Rating&nbsp;:
                            </label>
                            <div class="col-lg-6">
                                <select class="form-control" id="RatingId">
                                    <option value="Select" selected>--select--</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">

                            <label class="col-lg-4 col-form-label">Fax&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="FaxId">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">


                    <div class="col-lg-6">
                        <div class="form-group row offset-1">

                            <label class="col-lg-4 col-form-label">Country&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="CountryId">
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">

                            <label class="col-lg-4 col-form-label">State&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="StateId">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">


                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">City&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="CityId">
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">

                            <label class="col-lg-4 col-form-label">Street&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="StreetId">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">


                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Zip Code&nbsp;:</label>
                            <div class="col-lg-6">
                                <input type="text" class="form-control" id="ZipCodeId" value="0">
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group row offset-1">
                            <label class="col-lg-4 col-form-label">Description&nbsp;:</label>
                            <div class="col-lg-6">
                                <textarea class="form-control" id="DescriptionId" cols="20" rows="4"></textarea>
                            </div>
                        </div>
                    </div>
                </div>


                <hr class="my-3">


                <div class="table-responsive">
                    <table class="table align-items-center table-flush">
                        <thead class="thead-light">
                            <tr>
                                <th scope="col" class="sort" style="padding-left: 80px;"> NAME</th>
                                <th scope="col" class="sort" style="padding-left: 50px;">ACCOUNT NAME</th>
                                <th scope="col" class="sort">EMAIL</th>
                                <th scope="col" class="sort" style="padding-left: 50px;">PHONE</th>
                                <th scope="col" class="sort" style="padding-left: 30px;">DEPARTMENT	</th>

                            </tr>
                        </thead>
                        <tbody class="list" id="exam">
                        </tbody>

                    </table>
                </div>
            </div>
        </div>


    </div>
</div>
<!-- /main content code -->




<script src="../assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="../assets/vendor/js-cookie/js.cookie.js"></script>
<script src="../assets/vendor/jquery.scrollbar/jquery.scrollbar.min.js"></script>
<script src="../assets/vendor/jquery-scroll-lock/dist/jquery-scrollLock.min.js"></script>
<!-- Argon JS -->
<script src="../assets/js/argon.js?v=1.2.0"></script>
<script src="../assets/vendor/jquery/dist/jquery.min.js"></script>

<!-- Argon Scripts -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

<!--model link-->

<script src="../Model/CrmContact.js" type="text/javascript"></script>

<!--sidebar code-->
<script>
    $(document).ready(function () {

        $('#content').load("Sidebar.html");
        $(".UserId").val(localStorage.getItem('UName'));

    });</script>




<script>
    function set_MainHeaderName() {
        $('#MainPHead_Name').html('<i class="icon-arrow-left52 mr-2"></i> <span class="font-weight-semibold" id="main_id">CRM</span> - Lead');
        $('#MainPHead_Name1').html('<a href="#" class="breadcrumb-item"><i class="icon-home2 mr-2"></i>CRM</a><span class="breadcrumb-item active">Lead</span>');
    };
</script>

<!--dropdown list-->

<script type="text/javascript">
    $(function () {
        debugger
        GetParameterType('LDS');
        GetParameterType('RAT');
        GetParameterType('IND');
        GetParameterType('LST');
        GetParameterType('SAL');



    });
    //create first function for getparameretertypeid
    function GetParameterType(parametertype) {
        /* alert(parametertype);*/
        debugger
        var cccd = localStorage.getItem('CCAC');
        $.ajax({
            type: "GET",
            url: URLPowerAPI + '/api/PBXMLParameter/GetParameterTypeID',
            dataType: "json",
            contentType: "application/json",
            data: {
                PARTYPE: parametertype,
                cccd: cccd
            },
            beforeSend: function () {
                $("#loader1").show();
            },
            async: false,
            success: function (res) {
                $("#loader1").hide();
                var abc = res;
                GetDropDown(abc, parametertype);

            }

        });
    }


    //second function for dropdown
    function GetDropDown(parameter, parametertype) {
        debugger


        var cccd = localStorage.getItem('CCAC');
        $.ajax({
            type: "GET",
            url: URLPowerAPI + '/api/PBXMLParametercode/GetAllActiveParameterCodes',
            dataType: "json",
            contentType: "application/json",

            data: {
                PARTYPEID: parameter,
                cccd: cccd
            },
            beforeSend: function () {
                $("#loader1").show();
            },
            async: false,

            success: function (res) {
                $("#loader1").hide();

                $.each(res, function (data, value) {
                    if (parametertype == 'LDS') {
                        $("#LeadSorceId").append($("<option></option>").val(value.ParCodeID).html(value.ParCodeDescription));
                    }
                    else if (parametertype == 'RAT') {
                        $("#RatingId").append($("<option></option>").val(value.ParCodeID).html(value.ParCodeDescription));
                    }
                    else if (parametertype == 'LST') {
                        $("#LeadStatusId").append($("<option></option>").val(value.ParCodeID).html(value.ParCodeDescription));
                    }
                    else if (parametertype == 'IND') {
                        $("#IndustryId").append($("<option></option>").val(value.ParCodeID).html(value.ParCodeDescription));
                    }
                    else if (parametertype == 'SAL') {
                        $("#SalutationId").append($("<option></option>").val(value.ParCodeID).html(value.ParCodeDescription));
                    }
                })
            }

        });
    }
</script>


<!--add update API-->
<script>
    function AddFunction() {
        debugger
        var url1 = window.location.href;
        var arr = url1.split('=');
        console.log(url1.length)

        if (arr.length > 1) {
            var mode = url1.split("=")[2];
            var LeadNo1 = url1.split("=")[1];
            var index = (LeadNo1).indexOf('&');
            var LeadNo = LeadNo1.substring(0, index);

        }
        var urls = window.location.href;
        var cccd = localStorage.getItem('CCAC');

        var LeadSourceName = $("#LeadSorceId option:selected").text();
        var LeadSourceNo = $("#LeadSorceId option:selected").val();

        var IndustryName = $("#IndustryId option:selected").text();
        var IndustryNo = $("#IndustryId option:selected").val();

        var LeadStatusName = $("#LeadStatusId option:selected").text();
        var LeadStatusNo = $("#LeadStatusId option:selected").val();

        var RatingName = $("#RatingId option:selected").text();
        var RatingNo = $("#RatingId option:selected").val();
        var SalutationName = $("#SalutationId option:selected").text();
        var SalutationNo = $("#SalutationId option:selected").val();

        var CurrentDate = new Date();
        var curndate = CurrentDate.toISOString().replace('Z', '');
        var status = "A";


        //storesession value
        var UId;
        var Username;
        var Createdsystem;
        var Createdate;

        if (mode == 'edit') {
            LeadNo = LeadNo,
                UId = sessionStorage.getItem('uid');
            Username = sessionStorage.getItem('username');
            Createdsystem = sessionStorage.getItem('createdsystem');
            Createdate = sessionStorage.getItem('createddate');
        }
        else {
            LeadNo = localStorage.getItem("MaxLeadNo");
            UId = localStorage.getItem('UID');
            Username = localStorage.getItem('UName');
            Createdsystem = 'PowerSuit';
            Createdate = curndate;
        }




        var parameter =
        {
            LeadOwnerName: Username,
            LeadOwner: UId,
            LeadNo: LeadNo,
            Company: $("#ComapanyId").val(),
            FirstName: $("#FirstNameId").val(),
            LastName: $("#LastNameId").val(),
            Title: $("#").val(),
            Email: $("#EmailId").val(),
            Phone: $("#PhoneId").val(),
            Fax: $("#FaxId").val(),
            Mobile: $("#MobileId").val(),
            NoOfEmployees: $("#AnnualRevId").val(),
            AnnualRevenue: $("#NoOfEmpId").val(),
            Website: $("#WebSiteId").val(),
            Country: $("#CountryId").val(),
            Street: $("#StreetId").val(),
            City: $("#CityId").val(),
            ZipCode: $("#ZipCodeId").val(),
            State: $("#StateId").val(),
            Description: $("#DescriptionId").val(),
            SkypeID: $("#SkypeId").val(),
            LeadSourceName: LeadSourceName,
            LeadSourceNo: LeadSourceNo,
            LeadStatusName: LeadStatusName,
            LeadStatusNo: LeadStatusNo,
            IndustryName: IndustryName,
            IndustryNo: IndustryNo,
            RatingName: RatingName,
            RatingNo: RatingNo,
            SalutationName: SalutationName,
            SalutationNo: SalutationNo,
            CCCD: cccd,
            STATUS: status,
            CREATEDSYSTEM: Createdsystem,
            LASTUPDATEDSYSTEM: 'PowerSuit',
            UID: UId,
            USERNAME: Username,
            LUID: UId,
            LUSERNAME: localStorage.getItem('UName'),
            CREATEDDATE: Createdate,
            LASTUPDATEDDATE: curndate,
            CreatedBy: UId,
            LastUpdatedBy: UId,
            SFID: "1",
            SFXMLVAR:"SFXMLVAR"
        }
        return parameter;
    }

    $("#savebtnid").click(function () {
        /* alert("xsdc");*/
        var addparameter = AddFunction();
        localStorage.setItem("leadpar", JSON.stringify(addparameter));
        $.ajax
            ({
                type: 'POST',
                url: URLPowerAPI + '/api/PBXMLLead/AddPBXMLLead',
                dataType: 'JSON',
                data: JSON.stringify(addparameter),
                contentType: 'application/json ; charset = utf-8',
                beforeSend: function () {
                    $("#loader1").show();
                },
                success: function (data, textStatus, xhr) {
                    $("#loader1").hide();
                    alert('Lead registered successfully');
                    window.location.href = "LLLL-CR-LD-50.shtml";
                },
                error: function (xhr, textStatus, errorThrown) {
                    alert("You entered some invalid fields...! Fill the details again...");
                }
            });

        return;

    });

    $("#updatebtnID").click(function () {

        var addparameter = AddFunction();
        $.ajax
            ({
                type: 'POST',
                url: URLPowerAPI + '/api/PBXMLLead/EditPBXMLLead',
                dataType: 'JSON',
                data: JSON.stringify(addparameter),
                contentType: 'application/json ; charset = utf-8',

                success: function (data, textStatus, xhr) {
                    alert('Lead registered successfully');
                    window.location.href = "LLLL-CR-LD-50.shtml";
                },
                error: function (xhr, textStatus, errorThrown) {
                    alert("You entered some invalid fields...! Fill the details again...");
                }
            });
        return;
    });


</script>



<!--GET by id API-->
<script>
    $(document).ready(function () {
        debugger
        set_MainHeaderName();
        var url1 = window.location.href;
        var mode = url1.split("=")[2];
        var AccNo1 = url1.split("=")[1];
        var index = (AccNo1).indexOf("&");
        var AccNo = AccNo1.substring(0, index);
        var cccd = localStorage.getItem('CCAC');
        // alert(AccNo);

        if (mode == 'edit') {
            $.ajax({
                type: 'GET',
                url: URLPowerAPI + '/api/PBXMLLead/GetPBXMLLeadByID',
                dataType: 'JSON',
                contentType: 'application/json ; charset = utf-8',
                //data: JSON.stringify(groupname),
                data: {
                    cccd: cccd,
                    LeadNo: AccNo
                },

                beforeSend: function () {
                    $("#loader1").show();
                },

                success: function (data) {
                    // alert(JSON.stringify(data))


                    $("#loader1").hide();
                    data = data;
                    /*   alert(data + "abc");*/
                   // var singleValues = "2";
                   

                    $("#ComapanyId").val(data.Company);
                    $("#FirstNameId").val(data.FirstName);
                    $("#LastNameId").val(data.LastName);
                    $("#EmailId").val(data.Email);
                    $("#FaxId").val(data.Fax);
                    $("#MobileId").val(data.Mobile);
                    $("#AnnualRevId").val(data.AnnualRevenue);
                    $("#NoOfEmpId").val(data.NoOfEmployees);
                    $("#WebSiteId").val(data.Website);
                    $("#CountryId").val(data.Country);
                    $("#PhoneId").val(data.Phone);
                    $("#StreetId").val(data.Street);
                    $("#CityId").val(data.City);
                    $("#ZipCodeId").val(data.ZipCode);
                    $("#StateId").val(data.State);
                    $("#SkypeId").val(data.SkypeID);
                    $("#DescriptionId").val(data.Description);
                    // alert(data.NAME);
                    $('#LeadSorceId option:selected').text(data.LeadSourceName);
                    $('#LeadSorceId option:selected').val(data.LeadSourceNo);
                    $('#SalutationId option:selected').text(data.SalutationName);
                    $('#SalutationId option:selected').val(data.SalutationNo);

                    /* alert(data.LeadSourceName)*/
                    //  $('#IndustryId option:selected').val(data.IndustryNo);
                    // $('#IndustryId option:selected').val(data.IndustryNo);
                    // $('#IndustryId option:selected').val(data.IndustryNo);
                   // document.getElementById( "IndustryId").value = 2;

                    $('#IndustryId').val('five');
                

                  //  $("IndustryId").val("singleValues");


                    $('#LeadStatusId option:selected').text(data.LeadStatusName);
                    $('#LeadStatusId option:selected').val(data.LeadStatusNo);
                    $('#RatingId option:selected').text(data.RatingName);
                    $('#RatingId option:selected').val(data.RatingNo);

                    // alert("ADDLALLOCTYPE" + data.ADDLALLOCTYPE);





                    sessionStorage.setItem('uid', data.UID);
                    sessionStorage.setItem('username', data.USERNAME);
                    sessionStorage.setItem('createdsystem', data.CREATEDSYSTEM);
                    sessionStorage.setItem('createddate', data.CREATEDDATE);
                    sessionStorage.setItem('lastupdatedate', data.LASTUPDATEDDATE);

                },

            });
        }
        $("#deletebtnID").show();
        $("#updatebtnID").show();
        $("#savebtnid").hide();


        $("#deletebtnID").click(function () {
            debugger
            var urls = window.location.href;
            debugger
            //alert(urls);
            var cccd = localStorage.getItem('CCAC');
            var group = AccNo;

            $.ajax({
                url: URLPowerAPI + '/api/PBXMLLead/DeletePBXMLLead',
                type: 'GET',
                dataType: 'JSON',
                contentType: 'application/json ; charset = utf-8',
                data: {
                    cccd: cccd,
                    LeadNo: group
                },
                beforeSend: function () {
                    $("#loader1").show();
                },
                success: function (data, textStatus, xhr) {
                    $("#loader1").hide();
                    alert("Lead deleted successfully");
                    window.location.href = "LLLL-CR-LD-50.shtml";

                },
                error: function (xhr, textStatus, errorThrown) {
                    alert("You entered wrong password...! Fill the details again...");
                }
            });
        });

    });

</script>
<script>
    function set_MainHeaderName() {
        $('#MainPHead_Name').html('<i class="icon-arrow-left52 mr-2"></i> <span class="font-weight-semibold" id="main_id">CRM</span> - Lead');
        $('#MainPHead_Name1').html('<a href="#" class="breadcrumb-item"><i class="icon-home2 mr-2"></i>CRM</a><span class="breadcrumb-item active">Template</span>');
    };
</script>






