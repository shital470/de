<!-- Dashboard content -->
<!-- my code2 -->

<div class="row justify-content-center">
    <div class="col">
        <div class="card">
            <div class="card-header">
                <div class="row">
                    <div class="col-lg-6 col-xs-2">
                    </div>
                    <div class="col-lg-6">
                        <a href="#!" class="btn btn-sm btn-primary float-right" style="margin-right: 8px;" id="cancelbtnid">Cancel</a>
                        <a href="#!" class="btn btn-sm btn-primary float-right" style="margin-right: 8px; display: none;" id="deletebtnID">Delete</a>
                        <a href="#!" class="btn btn-sm btn-primary float-right" style="margin-right: 8px; display: none;" id="updatebtnID">Update</a>
                        <a href="#!" class="btn btn-sm btn-primary float-right" style="margin-right:8px;" id="savebtnid">Save</a>
                    </div>
                </div>
            </div>

            <!--Form layout-->

            <div class="card-body">
                <form class="fromcls">
                    <div class="pl-lg-4 abc">

                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group row">
                                    <label class="col-form-label col-lg-4">Subject*&nbsp;:</label>
                                    <div class="col-lg-6">
                                        <input type="text" class="form-control" id="SubjectID">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="form-group row">
                                    <label class="col-form-label col-lg-4" for="input-PayHeadName">Call Type&nbsp;:</label>
                                    <div class="col-lg-8">
                                        <div class="custom-control custom-switch custom-control-inline">
                                            <input type="radio" class="custom-control-input" name="CalculationId" id="YesCalculationId">
                                            <label class="custom-control-label" for="YesCalculationId">Inbound</label>
                                        </div>
                                        <div class="custom-control custom-switch custom-control-inline">
                                            <input type="radio" class="custom-control-input" name="CalculationId" id="NoCalculationId">
                                            <label class="custom-control-label" for="NoCalculationId">Outbound</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="form-group row">
                                    <label class="col-form-label col-lg-4">Call Purpose&nbsp;:</label>
                                    <div class="col-lg-6">
                                        <select class="form-control" id="CallPurposeId">
                                            <option>--Select--</option>
                                        </select>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">

                                <div class="form-group row">
                                    <label class="col-form-label col-lg-4" for="input-PayHeadName">Call From To*&nbsp;:</label>
                                    <div class="col-lg-8">
                                        <div class="custom-control custom-switch custom-control-inline">
                                            <input type="radio" class="custom-control-input" name="csr_selector" id="Contactid" value="1" onclick="show1();">
                                            <label class="custom-control-label" for="Contactid">Contact</label>
                                        </div>
                                        <div class="custom-control custom-switch custom-control-inline">
                                            <input type="radio" class="custom-control-input" name="csr_selector" id="LeadId" value="0" onclick="show2();">
                                            <label class="custom-control-label" for="LeadId">Lead</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="form-group row csSelectorShow" id="cs2" style="display: none;">
                                    <label class="col-form-label col-lg-4"> Lead Name&nbsp;:</label>
                                    <div class="col-lg-6">
                                        <select id="LeadNameId" class="form-control">


                                            <option>--Select--</option>
                                            <!--<option>Fixed</option>
                                            <option>variable</option>-->
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group row csSelectorShow" id="cs3">
                                    <label class="col-form-label col-lg-4">Contact Name&nbsp;:</label>
                                    <div class="col-lg-6">
                                        <select class="form-control" id="ContactNameId">
                                            <option value="Select" selected>--Select--</option>

                                        </select>
                                    </div>
                                </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group row  " id="cs3">
                                        <label class="col-form-label col-lg-4">Related To&nbsp;:</label>
                                        <div class="col-lg-6">
                                            <select class="form-control" id="RelatedToId" onclick="DropDownSelVal(this)">
                                                <option value="Select" selected>--Select--</option>

                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group row " id="cs4">
                                        <label class="col-form-label col-lg-4">&nbsp;</label>
                                        <div class="col-lg-6">
                                            <select class="form-control" id="RelatedValueId">
                                                <option value="Select" selected>--Select--</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-8">
                                <h3 class="col-0">Call Details&nbsp;:</h3>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">


                                    <div class="form-group row">
                                        <label class="col-form-label col-lg-4">Call Start Time*&nbsp;:</label>
                                        <div class="col-lg-8 form-group row">
                                            <div class="input-group col-md-6">
                                                <span class="input-group-prepend">
                                                    <span class="input-group-text"><i class="icon-calendar22"></i></span>
                                                </span>
                                                <input type="text" class="form-control daterange-single" id="CallStartDateId" style="padding-right: 0px;padding-left: 0px;">
                                            </div>
                                            <div class="col-md-2" style="padding:0px;">
                                                <select class="form-control 1-12" style="padding:2px;" id="CallStartHrId">
                                                    <option></option>

                                                </select>
                                            </div>
                                            <div class="col-md-2" style="padding:0px;">

                                                <select class="form-control 1-50" style="padding:2px;" id="CallStartMinId">
                                                    <option></option>
                                                </select>
                                            </div>
                                            <div class="col-md-2" style="padding:0px;">
                                                <select class="form-control" style="padding:2px;" id="CallStartPmAmId">
                                                    <option>AM</option>
                                                    <option>PM</option>
                                                </select>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group row">
                                        <label class="col-form-label col-lg-4">Call Duration*&nbsp;:</label>
                                        <div class="col-lg-2">
                                            <input type="number" class="form-control" id="CallDMinId">
                                        </div>
                                        <label class="col-form-label">Minutes</label>
                                        <div class="col-lg-2">
                                            <input type="number" class="form-control" id="CallDSecID">
                                        </div>
                                        <label class="col-form-label">Seconds</label>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group row">
                                        <label class="col-form-label col-lg-4">Description&nbsp;:</label>
                                        <div class="col-lg-6">
                                            <textarea class="form-control" id="DiscriptionId" style="resize:none"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group row">
                                        <label class="col-form-label col-lg-4">Call Result&nbsp;:</label>
                                        <div class="col-lg-6">
                                            <input type="text" class="form-control" id="CallResultId">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row" style=" margin-top:10px;">

                                <div class="col-md-2">
                                    <div class="form-group" style="margin:0px;">
                                        <label class="col-form-label">Billable&nbsp;:</label>

                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group row">

                                        <input type="checkbox" class="form-control" id="BilableId">

                                    </div>
                                </div>

                            </div>
                        </div>
                </form>
            </div>
        </div>
    </div>
</div>
<style>
    /* Chrome, Safari, Edge, Opera */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }

    /* Firefox */
    input[type=number] {
        -moz-appearance: textfield;
    }
</style>


<!--<script src="../assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="../assets/vendor/js-cookie/js.cookie.js"></script>
<script src="../assets/vendor/jquery.scrollbar/jquery.scrollbar.min.js"></script>
<script src="../assets/vendor/jquery-scroll-lock/dist/jquery-scrollLock.min.js"></script>-->
<!-- Argon JS -->
<!--<script src="../assets/js/argon.js?v=1.2.0"></script>
<script src="../assets/vendor/jquery/dist/jquery.min.js"></script>-->

<!-- Argon Scripts -->
<!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>-->

<!--model link-->

<!--<script src="../Model/CrmContact.js" type="text/javascript"></script>-->


<!--radio btn hide show-->
<!--<script>
          
    $('[name=csr_selector]').change(function () {
        $('.csSelectorShow').each(function () {
            $(this).toggle();
        });
    });
</script>-->
<script>
    //function show1() {
    //    document.getElementsByClassName('csSelectorShow').style.display = 'none';
    //}

    function show2() {
        $("#cs2").show();
        $("#cs3").hide();
        //$('#cs2').each(function () {
        //    /* $(this).toggle();*/
        //    $("#cs2").show();
        //    $("#cs3").hide();
          
        //});
    }
    function show1() {
        
           
            var abc = document.getElementById("cs3")
            if ("abc==hide") {
                $("#cs3").show();
                $("#cs2").hide();
            }

       
    }
</script>
<script>
    $(function () {
        debugger
        var $select = $(".1-50");
        for (i = 1; i <= 50; i++) {

            $select.append($('<option></option>').val(i).html(i))
        }
    });
</script>
<script>
    $(function () {
        var $select = $(".1-12");
        for (i = 1; i <= 12; i++) {
            $select.append($('<option></option>').val(i).html(i))
        }
    });
</script>
<!--sidebar code-->
<script>
    $(document).ready(function () {

        set_MainHeaderName();

    });</script>


<!--dropdown list-->





<script type="text/javascript">
    $(function () {
        debugger
        GetParameterType('CAP');
        GetParameterType('SRS');

    });
    //create first function for getparameretertypeid
    function GetParameterType(parametertype) {
        debugger
        var cccd = localStorage.getItem('CCAC');
        $.ajax({
            async: false,
            type: "GET",
            url: URLPowerAPI+'/api/PBXMLParameter/GetParameterTypeID',
            dataType: "json",
            contentType: "application/json",

            data: {
                PARTYPE: parametertype,
                cccd: cccd
            },
            beforeSend: function () {
                $("#loader1").show();
            },
            async: false,
            success: function (res) {
                $("#loader1").hide();
                var abc = res;
                GetDropDown(abc, parametertype);

            }

        });
    }


    //second function for dropdown
    function GetDropDown(parameter, parametertype) {
        debugger


        var cccd = localStorage.getItem('CCAC');
        var relatedto;
        $.ajax({
            async: false,
            type: "GET",
            url: URLPowerAPI+'/api/PBXMLParametercode/GetAllActiveParameterCodes',
            dataType: "json",
            contentType: "application/json",

            data: {
                PARTYPEID: parameter,
                cccd: cccd
            },
            async: false,

            success: function (res) {
                var related2 = [];
                var relatedto;
                $.each(res, function (data, value) {

                    if (parametertype == 'CAP') {
                        $("#CallPurposeId").append($("<option></option>").val(value.ParCodeID).html(value.ParCodeDescription));
                    }
                    else if (parametertype == 'SRS') {
                        $("#RelatedToId").append($("<option></option>").val(value.ParCodeID).html(value.ParCodeDescription));
                        relatedto = value.ParCodeDescription;
                        //alert(relatedto + "RelatedToooo");
                        related2.push(relatedto);

                    }



                })
                //alert(related2 + "wholes a");
                // DropDownSel(related2);
            }

        });
    }





    $(document).ready(function () {
        $("#RelatedToId").change(function () {
            debugger
          
            var relatedval = $("#RelatedToId option:selected").text();
            var cccd = localStorage.getItem('CCAC');
            if (relatedval == "Account") {
                $("#RelatedValueId").html("");
                $.ajax({

                    url: URLPowerAPI+'/api/PBXMLAccounts/GetAllCustomer',
                    type: 'GET',
                    dataType: 'json',
                    contentType: 'application/json ; charset = utf-8',
                    data: {
                        cccd: cccd
                    },
                    async: false,
                    success: function (res) {

                        $.each(res, function (index, value) {
                            $("#RelatedValueId").append($("<option></option>").val(value.ClId).html(value.Name));
                        });

                    }

                });

            }
            else if (relatedval == "Campaign") {
                $("#RelatedValueId").html("");
                $.ajax({

                    url: URLPowerAPI+'/api/PBXMLVCampaign/GetAllPBXMLCampaign',
                    type: 'GET',
                    dataType: 'json',
                    contentType: 'application/json ; charset = utf-8',
                    data: {
                        cccd: cccd
                    },
                    async: false,
                    success: function (res) {

                        $.each(res, function (index, value) {
                            $("#RelatedValueId").append($("<option></option>").val(value.CampaignNo).html(value.CampaignName));
                        });

                    }

                });

            } else if (relatedval == "Case") {
                //  document.getElementById(RelatedValueId).innerHTML = " " ;
                $("#RelatedValueId").html("");
                $.ajax({

                    url: URLPowerAPI+'/api/PBXMLVCase/GetAllPBXMLCase',
                    type: 'GET',
                    dataType: 'json',
                    contentType: 'application/json ; charset = utf-8',
                    data: {
                        cccd: cccd
                    },
                    async: false,
                    success: function (res) {

                        $.each(res, function (index, value) {
                            $("#RelatedValueId").append($("<option></option>").val(value.CaseNo).html(value.Subject));
                        });

                    }

                });
            }
            else if (relatedval == "Contact") {
                $("#RelatedValueId").html("");
                $.ajax({

                    url: URLPowerAPI+'/api/PBXMLVContact/GetAllPBXMLContacts',
                    type: 'GET',
                    dataType: 'json',
                    contentType: 'application/json ; charset = utf-8',
                    data: {
                        cccd: cccd
                    },
                    async: false,
                    success: function (res) {

                        $.each(res, function (index, value) {
                            $("#RelatedValueId").append($("<option></option>").val(value.ContactNo).html(value.FirstName));
                        });

                    }

                });
            }
            else if (relatedval == "Lead") {
                $("#RelatedValueId").html("");
                $.ajax({

                    url: URLPowerAPI+'/api/PBXMLVLead/GetAllPBXMLLead',
                    type: 'GET',
                    dataType: 'json',
                    contentType: 'application/json ; charset = utf-8',
                    data: {
                        cccd: cccd
                    },
                    async: false,
                    success: function (res) {

                        $.each(res, function (index, value) {
                            $("#RelatedValueId").append($("<option></option>").val(value.LeadNo).html(value.FirstName));
                        });

                    }

                });
            }
            else if (relatedval == "Opportunity") {
                $("#RelatedValueId").html("");
                $.ajax({

                    url: URLPowerAPI+'/api/PBXMLVOpportunity/GetAllPBXMLOpportunity',
                    type: 'GET',
                    dataType: 'json',
                    contentType: 'application/json ; charset = utf-8',
                    data: {
                        cccd: cccd
                    },
                    async: false,
                    success: function (res) {

                        $.each(res, function (index, value) {
                            $("#RelatedValueId").append($("<option></option>").val(value.OppNo).html(value.OppName));
                        });

                    }

                });
            }
            else if (relatedval == "Potential") {
                $("#RelatedValueId").html("");
                $.ajax({

                    url: URLPowerAPI+'/api/PBXMLVPotential/GetAllPBXMLPotential',
                    type: 'GET',
                    dataType: 'json',
                    contentType: 'application/json ; charset = utf-8',
                    data: {
                        cccd: cccd
                    },
                    async: false,
                    success: function (res) {

                        $.each(res, function (index, value) {
                            $("#RelatedValueId").append($("<option></option>").val(value.PotentialNo).html(value.PotentialName));
                        });

                    }

                });
            }
            else if (relatedval == "Product") {
                $("#RelatedValueId").html("");
                $.ajax({

                    url: URLPowerAPI+'/api/PBXMLVStockGroups/GetAllPBXMLVStockGroup',
                    type: 'GET',
                    dataType: 'json',
                    contentType: 'application/json ; charset = utf-8',
                    data: {
                        cccd: cccd
                    },
                    async: false,
                    success: function (res) {

                        $.each(res, function (index, value) {
                            $("#RelatedValueId").append($("<option></option>").val(value.Itcd).html(value.STOCKGROUP));
                        });

                    }

                });
            }
        });

    });
</script>

<script type="text/javascript">
    $(function () {
        debugger
        var cccd = localStorage.getItem('CCAC');

        $.ajax
            ({

                url: URLPowerAPI+'/api/PBXMLVContact/GetAllPBXMLContacts',
                type: 'GET',
                dataType: 'json',
                contentType: 'application/json ; charset = utf-8',
                data:
                {
                    cccd: cccd

                },
                async: false,
                success: function (res) {
                    //alert("Data inside ajax...!!!")
                    $.each(res, function (index, value) {

                        var contactname = value.FirstName + " " + value.LastName;
                        $("#ContactNameId").append($("<option></option>").val(value.ContactNo).html(contactname));



                    });
                }

            });

    });



</script>


<script type="text/javascript">
    $(function () {
        debugger
        var cccd = localStorage.getItem('CCAC');

        $.ajax
            ({

                url: URLPowerAPI + 'api/PBXMLVLead/GetAllPBXMLLead',
                type: 'GET',
                dataType: 'json',
                contentType: 'application/json ; charset = utf-8',
                data:
                {
                    cccd: cccd

                },
                async: false,
                success: function (res) {
                    alert("Data inside ajax...!!!")
                    $.each(res, function (index, value) {

                        var Leadname = value.FirstName + " " + value.LastName;
                        $("#LeadNameId").append($("<option></option>").val(value.LeadNo).html(Leadname));



                    });
                }

            });

    });



</script>



<!--add edit code-->
<script>


</script>

<script type="text/javascript">
    function Groupfunction() {
        // alert("in function");
        debugger
        var url1 = window.location.href;
        var arr = url1.split('=');
        console.log(url1.length)

        if (arr.length > 1) {
            var mode = url1.split("=")[2];
            var AccNo1 = url1.split("=")[1];
            var index = (AccNo1).indexOf('&');
            var AccNo = AccNo1.substring(0, index);

        }

        var CallHr = $("#CallStartHrId").val();


        //alert(CallHr + "CallHr1111");
        var Callmin = $("#CallStartMinId").val();

        var x = Callmin.charAt(0);
        //alert("X" + x)
        if (Callmin <= 9 && x != 0) {

            Callmin = "0" + Callmin;
        }
        var PmAm = $("#CallStartPmAmId").val();
        var CallSec = "0" + "0";

        if (PmAm == 'PM') {
            CallHr = parseInt(CallHr) + parseInt(12);
            var callhrminpmam = CallHr + ":" + Callmin + ":" + CallSec;

        }
        else if (PmAm == 'AM') {
            var cxh = String(CallHr)[0];
            if (CallHr <= 9 && cxh != 0) {
                CallHr = "0" + CallHr;
            }

            var callhrminpmam = CallHr + ":" + Callmin + ":" + CallSec;
        }





        var cccd = localStorage.getItem('CCAC');
        if ($("#YesCalculationId").prop("checked")) {
            var caltype = "Inbound"
        }
        else {
            var caltype = "Outbound"
        }
        if ($("#Contactid").prop("checked")) {
            var ClFrmTo ="Contact"
            conleadval = document.getElementById('Contactid').value; 
            var ContactPersonName = $("#ContactNameId option:selected").text();
            var ContactName = $("#ContactNameId option:selected").val();
        }
        else {
            var ClFrmTo = "Lead"
            conleadval = document.getElementById('LeadId').value;
            var ContactPersonName = $("#LeadNameId option:selected").text();
            var ContactName = $("#LeadNameId option:selected").val();
        }
        //$("input[type='radio'][name='csr_selector']:checked").val();
        //if (document.getElementById('Contactid').checked) {
        //    rate_value = document.getElementById('Contactid').value;
        //    alert(rate_value);
        //}

        if ($('#BilableId').is(":checked")) {
            var Billable = "True"
        }
        else {
            var Billable = "False"
        }


        var RelatedToName = $("#RelatedValueId option:selected").text();
        var RelatedTo = $("#RelatedValueId option:selected").val();

        var AccountOptionName = $("#RelatedToId option:selected").text();
        var AccountOption = $("#RelatedToId option:selected").val();
        var CallPurposeName = $("#CallPurposeId option:selected").text();
        var CallPurpose = $("#CallPurposeId option:selected").val();
      
        var CallStartDate = $("#CallStartDateId").val();
       // var CallStartDate1 = CallStartDate.replace(/\//g, "-");
        var mon = CallStartDate.substring(0, 2);
        var day = CallStartDate.split("/")[1];
        var year = CallStartDate.split("/")[2];
        var CallStartDate1 = year + "-" + mon + "-" + day;
        //var index = (Id1).indexOf('&');
       // var Id = Id1.substring(0, index);
       // var year = CallStartDate.getFullYear();

       // var dtm = CallStartDate.getMonth();
       // alert(day);
        alert(CallStartDate1 + "CallStartDate1");

        var CallStartDatetime = CallStartDate1 + "T" + callhrminpmam;
        //alert(CallStartDatetime + "CallStartDatetime");
        var CallDMin = $("#CallDMinId").val();
        var x = CallDMin.charAt(0);
        if (CallDMin <= 9 && x != 0) {
            CallDMin = "0" + CallDMin;
        }
        //alert(CallDMin);
        var CallDSec = $("#CallDSecID").val();
        var x = CallDSec.charAt(0);
        if (CallDSec <= 9 && x != 0) {
            CallDSec = "0" + CallDSec;
        }
        //alert(CallDSec);
        var CallDTime = "00" + ":" + CallDMin + ":" + CallDSec;
        //alert(CallDTime);


        var Endmin = parseInt(Callmin) + parseInt(CallDMin);
        if (Endmin >= 60) {
            var h = (Endmin / 60) << 0
            var EndHr = parseInt(CallHr) + parseInt(h);
            var xh = String(EndHr)[0];
            if (EndHr <= 9 && xh != 0) {
                EndHr = "0" + EndHr;
            }
            Endmin -= 60 * h
            var xm = String(Endmin)[0];
        }

        else {
            EndHr = CallHr;
        }

        if (Endmin <= 9 && xm != 0) {
            Endmin = "0" + Endmin;
        }

        var EndSec = parseInt(CallSec) + parseInt(CallDSec);

        if (EndSec >= 60) {
            var m = (EndSec / 60) << 0
            var Endmin = parseInt(Callmin) + parseInt(m);
            EndSec -= 60 * m

        }
        var xs = String(EndSec)[0];
        if (EndSec <= 9 && xs != 0) {
            EndSec = "0" + EndSec;
        } else if (EndSec == "0") {
            EndSec = "0" + EndSec;
        }

        //alert("EndSec" + EndSec);
        var EndDateTime = CallStartDate1 + "T" + EndHr + ":" + Endmin + ":" + EndSec;
        var duedate1 = CallStartDatetime;
        var duedate = duedate1;
       /* duedate = duedate1.replace('T', ' ');*/

        var CurrentDate = new Date();

        var curndate = CurrentDate.toISOString().replace('Z', ' ');
       // alert(curndate + "CurrentDate");
        var status = "A";


        //storesession value
        var UId;
        var Username;
        var Createdsystem;
        var Createdate;

        if (mode == 'edit') {
            ActivityNo = AccNo,
            UId = sessionStorage.getItem('uid');
            Username = sessionStorage.getItem('username');
            Createdsystem = sessionStorage.getItem('createdsystem');
            Createdate = curndate;
        }
        else {
           ActivityNo = localStorage.getItem('MaxActivityNo');

            UId = localStorage.getItem('UID');
            Username = localStorage.getItem('UName');
            Createdsystem = 'PowerSuit';
            Createdate = curndate;
        }

        var parameter = {
            ActivityOwnerName: Username,
            ActivityOwner: UId,
            ActivityNo: ActivityNo,
            Subject: $("#SubjectID").val(),
           // NAME: $("#SubjectID").val(),
            ContactLead: conleadval,
            ActivityType: 'Call',
            CallType: caltype,
            ContactName: ContactName,
            ContactPersonName: ContactPersonName,
            AccountOption: AccountOption,
            AccountOptionName: AccountOptionName,
            RelatedToName: RelatedToName,
            RelatedTo: RelatedTo,
            CallPurposeName: CallPurposeName,
            CallPurpose: CallPurpose,
            Description:$("#DiscriptionId").val(),
            CallResult: $("#CallResultId").val(),
            StartDateTime: CallStartDatetime,
            EndDateTime: EndDateTime,
            CallStartTime: CallStartDatetime,
            SendNoficatnEmail: 'False',
            RecurringActivity: "",
            Venue: "",
            DueDate: duedate,
            CallDuration: CallDTime,
            CallDurationInSec:'0',
            Billable: Billable,
            Status:'0',
            StatusName: "",
            Priority: '0',
            PriorityName:"",
            CCCD: cccd,
            STATUS: status,
            CREATEDSYSTEM: 'PowerBooksCRM',
            LASTUPDATEDSYSTEM: 'PowerBooksCRM',
            UserName: Username,
            LUID: UId,
            LUserName: Username,
            CreatedBy: UId,
            UID: UId,
            CreatedDate: Createdate,
            CREATEDDATE: Createdate,
            LastUpdatedBy: UId,
            LastUpdatedDate: Createdate,
            SFID: "",
            SFXMLVAR:'SFXMLVAR'








        }
        return parameter
    }
    $("#savebtnid").click(function () {

        // alert("ghggg");
        var addgroupparameter = Groupfunction();
        localStorage.setItem("addcallgroupparameter", JSON.stringify(addgroupparameter));
        // alert(addcostcatparameter + "json");

        debugger
        $.ajax
            ({
                type: 'POST',
                url: URLPowerAPI+'/api/PBXMLActivities/AddPBXMLActivities',
                dataType: 'JSON',
                data: JSON.stringify(addgroupparameter),

                contentType: 'application/json ; charset = utf-8',

                success: function (data, textStatus, xhr) {

                    alert('Customer registered successfully');
                    window.location.href = "LLLL-CR-SC-50.shtml";
                },
                error: function (xhr, textStatus, errorThrown) {
                    alert("You entered some invalid fields...! Fill the details again...");
                }
            });

        return;

    });

    $("#updatebtnID").click(function () {
        debugger
        var addgroupparameter = Groupfunction();
        localStorage.setItem("callarameteredit", JSON.stringify(addgroupparameter));
        $.ajax
            ({
                type: 'POST',
                url: URLPowerAPI+'/api/PBXMLActivities/EditPBXMLActivities',
                dataType: 'JSON',
                data: JSON.stringify(addgroupparameter),
                contentType: 'application/json ; charset = utf-8',

                success: function (data, textStatus, xhr) {
                    alert('Customer registered successfully');
                    window.location.href = "LLLL-CR-SC-50.shtml";
                },
                error: function (xhr, textStatus, errorThrown) {
                    alert("You entered some invalid fields...! Fill the details again...");
                }
            });
        return;

    });
</script>





<!--GET API-->
<script>
    $(document).ready(function () {
        debugger
       /* set_MainHeaderName();*/
        var url1 = window.location.href;
        var mode = url1.split("=")[2];
        var Id1 = url1.split("=")[1];
        var index = (Id1).indexOf('&');
        var Id = Id1.substring(0, index);
        var cccd = localStorage.getItem('CCAC');

        if (mode == 'edit') {
            $.ajax({
                type: 'GET',
                url: URLPowerAPI+'/api/PBXMLActivities/GetPBXMLActivitiesByID',
                dataType: 'JSON',
                contentType: 'application/json ; charset = utf-8',
                data: {
                    cccd: cccd,
                    ActivityNo: Id
                },
                beforeSend: function () {
                    $("#loader1").show();
                },

                contentType: 'application/json ; charset = utf-8',
               
                success: function (data) {
                    debugger
                    localStorage.setItem("getcalldata", JSON.stringify(data));
                    $("#loader1").hide();
                    //data = data;
                    //alert(JSON.stringify(data));

                    var time = data.CallDuration;
                   // alert(time + "time");
                    var CallDMin = time.split(":")[1];
                    var CallDSec = time.split(":")[2];

                    /*   Call Start DateTime */
                    var CallStartTime = data.CallStartTime;
                    //alert(CallStartTime + "CallStartTime");
                    var index = (CallStartTime).indexOf('T');
                    var CallStartTime2 = CallStartTime.substring(0, index);


                    var year = CallStartTime2.substring(0, 4);
                    var mon = CallStartTime2.split("-")[1];
                    var day = CallStartTime2.split("-")[2];
                    var CallStartTime1 = mon + "/" + day + "/" + year;



                    //alert(CallStartTime1 + "ali ka date");
                 
                    var Callhr1 = CallStartTime.split("T")[1];
                    var Callhr = Callhr1.substring(0, 2);
                    //alert(Callhr + "Call hr")
                    var Callmin = CallStartTime.split(":")[1];
                   // alert(Callmin + "Callmin");

                    if (Callhr > 12) {
                        Callhr = parseInt(Callhr) - parseInt(12);
                        Callhr = Callhr;
                        alert(CallHr + "CallHr++");
                        PmAm = "PM";
                        alert(PmAm + "PmAm++");
                    }
                    else if (Callhr <= 12 || Callhr == "00") {
                        Callhr = Callhr;
                        PmAm = "AM";
                        alert(PmAm + "PmAm+++");
                    }




                 

                    $("#SubjectID").val(data.Subject);
                    if (data.CallType == 'Inbound') {
                        $("#YesCalculationId").attr('checked', 'checked');
                    } else {
                        $("#NoCalculationId").attr('checked', 'checked');
                    }
                    //$('#CallPurposeId option:selected').text(data.CallPurposeName);
                    if (data.ContactLead == 'Contact') {
                        $("#Contactid").attr('checked', 'checked');
                    } else {
                        $("#LeadId").attr('checked', 'checked');
                    }
                    $('#ContactNameId option:selected').text(data.ContactPersonName);
                    $('#ContactNameId option:selected').val(data.ContactName);


                    $('#RelatedToId option:selected').text(data.AccountOptionName);
                    $('#RelatedToId option:selected').val(data.AccountOption);

                    $('#RelatedValueId option:selected').text(data.RelatedToName);
                    $('#RelatedValueId option:selected').val(data.RelatedTo);
                   // alert(data.CallPurposeName + "CallPurposeName")
                    $('#CallPurposeId option:selected').text(data.CallPurposeName);
                    $('#CallPurposeId option:selected').val(data.CallPurpose);

                    $("#DiscriptionId").val(data.Description);
                    $("#CallResultId").val(data.CallResult);

                    $("#CallDMinId").val(CallDMin);
                    $("#CallDSecID").val(CallDSec);
                    $("#CallStartDateId").val(CallStartTime1);
                    $('#CallStartHrId option:selected').text(Callhr);
                    $('#CallStartMinId option:selected').text(Callmin);
                    //$("#CallStartHrId").val(Callhr);
                    //$("#CallStartMinId").val(Callmin);

                   // alert(data.Billable + "Billableeeeeeeeeeeee");
                    if (data.Billable == 'True') {
                        $("#BilableId").attr('checked', 'checked');
                    }


                    sessionStorage.setItem('uid', data.UID);
                    // alert(data.UID+"uid");
                    sessionStorage.setItem('username', data.USERNAME);
                    sessionStorage.setItem('createdsystem', data.CREATEDSYSTEM);
                    sessionStorage.setItem('CreatedDate', data.CreatedDate);
                    sessionStorage.setItem('LastUpdatedDate', data.LastUpdatedDate);





                },

            });


        }

        $("#deletebtnID").show();
        $("#updatebtnID").show();
        $("#savebtnid").hide();




        $("#deletebtnID").click(function () {
            var url1 = window.location.href;
            var mode = url1.split("=")[2];
            var Id1 = url1.split("=")[1];
            var index = (Id1).indexOf('&');
            var Id = Id1.substring(0, index);
            var cccd = localStorage.getItem('CCAC');
            $.ajax({
                url: URLPowerAPI+'/api/PBXMLActivities/DeletePBXMLActivities',
                type: 'GET',
                dataType: 'JSON',
                data: {
                    cccd: cccd,
                    ActivityNo: Id

                },

                contentType: 'application/json ; charset = utf-8',
                success: function (data, textStatus, xhr) {
                    alert("PBXMLActivities deleted successfully");
                    window.location.href = "LLLL-CR-SC-50.shtml";

                },
                error: function (xhr, textStatus, errorThrown) {
                    alert("You entered wrong password...! Fill the details again...");
                }
            });
        });
    });
    function set_MainHeaderName() {
        $('#MainPHead_Name').html('<i class="icon-arrow-left52 mr-2"></i> <span class="font-weight-semibold" id="main_id">CRM</span> - Activities - Schedule Call');
        $('#MainPHead_Name1').html('<a href="#" class="breadcrumb-item"><i class="icon-home2 mr-2"></i>CRM</a><span class="breadcrumb-item active">Activities / Schedule Call</span>');
    }
</script>





